{"remainingRequest":"/Users/scottjoscelyne/Desktop/oasis/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--8-1!/Users/scottjoscelyne/Desktop/oasis/node_modules/formiojs/components/datamap/DataMap.js","dependencies":[{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/formiojs/components/datamap/DataMap.js","mtime":1581861142225},{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/cache-loader/dist/cjs.js","mtime":1571276078087},{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1571276072802}],"contextDependencies":[],"result":["\"use strict\";\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.concat\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of\");\n\nrequire(\"core-js/modules/es.object.keys\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.reflect.get\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _Base = _interopRequireDefault(require(\"../base/Base\"));\n\nvar _NestedComponent2 = _interopRequireDefault(require(\"../nested/NestedComponent\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _utils = require(\"../../utils/utils\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nvar DataMapComponent =\n/*#__PURE__*/\nfunction (_NestedComponent) {\n  _inherits(DataMapComponent, _NestedComponent);\n\n  _createClass(DataMapComponent, [{\n    key: \"schema\",\n    get: function get() {\n      var schema = _get(_getPrototypeOf(DataMapComponent.prototype), \"schema\", this);\n\n      schema.valueComponent = this.components[this.components.length - 1].schema;\n      return _lodash.default.omit(schema, 'components');\n    }\n  }], [{\n    key: \"schema\",\n    value: function schema() {\n      for (var _len = arguments.length, extend = new Array(_len), _key = 0; _key < _len; _key++) {\n        extend[_key] = arguments[_key];\n      }\n\n      return _Base.default.schema.apply(_Base.default, [{\n        label: 'Data Map',\n        key: 'dataMap',\n        type: 'datamap',\n        clearOnHide: true,\n        addAnother: 'Add Another',\n        disableAddingRemovingRows: false,\n        keyBeforeValue: true,\n        valueComponent: {\n          type: 'textfield',\n          key: 'value',\n          label: 'Value',\n          defaultValue: 'Value',\n          input: true\n        },\n        input: true,\n        validate: {\n          maxLength: 0,\n          minLength: 0\n        }\n      }].concat(extend));\n    }\n  }, {\n    key: \"builderInfo\",\n    get: function get() {\n      return {\n        title: 'Data Map',\n        icon: 'fa fa-th-list',\n        group: 'data',\n        documentation: 'http://help.form.io/userguide/#datamap',\n        weight: 25,\n        schema: DataMapComponent.schema()\n      };\n    }\n  }]);\n\n  function DataMapComponent(component, options, data) {\n    var _this;\n\n    _classCallCheck(this, DataMapComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(DataMapComponent).call(this, component, options, data));\n    _this.type = 'datamap';\n    _this.rows = {};\n    return _this;\n  }\n\n  _createClass(DataMapComponent, [{\n    key: \"hasAddButton\",\n    value: function hasAddButton() {\n      var maxLength = _lodash.default.get(this.component, 'validate.maxLength');\n\n      return !this.component.disableAddingRemovingRows && !this.shouldDisable && !this.options.builder && !this.options.preview && (!maxLength || Object.keys(this.dataValue).length < maxLength);\n    }\n  }, {\n    key: \"hasRemoveButtons\",\n    value: function hasRemoveButtons() {\n      return !this.component.disableAddingRemovingRows && !this.shouldDisable && !this.options.builder && Object.keys(this.dataValue).length > _lodash.default.get(this.component, 'validate.minLength', 0);\n    }\n  }, {\n    key: \"hasChanged\",\n    value: function hasChanged(newValue, oldValue) {\n      return !_lodash.default.isEqual(newValue, oldValue);\n    }\n  }, {\n    key: \"build\",\n    value: function build(state) {\n      var _this2 = this;\n\n      if (this.options.builder) {\n        return _get(_getPrototypeOf(DataMapComponent.prototype), \"build\", this).call(this, state, true);\n      }\n\n      this.createElement();\n      this.createLabel(this.element);\n      var tableClass = 'table datagrid-table table-bordered form-group formio-data-map ';\n\n      _lodash.default.each(['striped', 'bordered', 'hover', 'condensed'], function (prop) {\n        if (_this2.component[prop]) {\n          tableClass += \"table-\".concat(prop, \" \");\n        }\n      });\n\n      this.tableElement = this.ce('table', {\n        class: tableClass\n      });\n      this.buildRows(state);\n      this.element.appendChild(this.tableElement);\n      this.createDescription(this.element);\n      this.attachLogic();\n    }\n  }, {\n    key: \"addKeyButton\",\n    value: function addKeyButton() {\n      var _this3 = this;\n\n      if (!this.hasAddButton()) {\n        return null;\n      }\n\n      var addButton = this.ce('button', {\n        class: 'btn btn-primary formio-button-add-row'\n      });\n      this.addEventListener(addButton, 'click', function (event) {\n        event.preventDefault();\n\n        _this3.addRow();\n      });\n      addButton.appendChild(this.ce('i', {\n        class: this.iconClass('plus')\n      }));\n      addButton.appendChild(this.text(' '));\n      addButton.appendChild(this.text(this.component.addAnother || 'Add Another'));\n      return addButton;\n    }\n  }, {\n    key: \"removeKeyButton\",\n    value: function removeKeyButton(key) {\n      var _this4 = this;\n\n      var removeButton = this.ce('button', {\n        type: 'button',\n        class: 'btn btn-default btn-secondary formio-button-remove-row'\n      });\n      this.addEventListener(removeButton, 'click', function (event) {\n        event.preventDefault();\n\n        _this4.removeRow(key);\n      });\n      removeButton.appendChild(this.ce('i', {\n        class: this.iconClass('remove-circle')\n      }));\n      return removeButton;\n    } // Build the header.\n\n  }, {\n    key: \"createHeader\",\n    value: function createHeader() {\n      var valueHeader = this.ce('th', {\n        'class': 'col-9 col-sm-8'\n      }, this.text(this.component.valueComponent.label));\n\n      if (this.component.valueComponent.tooltip) {\n        this.createTooltip(valueHeader, {\n          tooltip: this.t(this.component.valueComponent.tooltip)\n        });\n      }\n\n      var keyHeader = this.ce('th', {\n        'class': 'col-2 col-sm-3'\n      }, this.text(this.component.keyLabel || 'Key'));\n      this.createTooltip(keyHeader, {\n        tooltip: this.t('Enter the map \"key\" for this value.')\n      });\n      return this.ce('thead', null, this.ce('tr', {\n        class: 'd-flex'\n      }, [this.component.keyBeforeValue ? keyHeader : valueHeader, this.component.keyBeforeValue ? valueHeader : keyHeader, this.hasRemoveButtons() ? this.ce('th', {\n        'class': 'col-1 col-sm-1'\n      }, null) : null]));\n    }\n  }, {\n    key: \"buildRows\",\n    value: function buildRows(state) {\n      var _this5 = this;\n\n      // Do not builder rows when in builder mode.\n      if (this.options.builder) {\n        return;\n      } // Destroy all value components before they are recreated.\n\n\n      this.destroyComponents();\n\n      _lodash.default.each(this.rows, function (row) {\n        return row.value.destroy();\n      });\n\n      this.rows = {};\n      this.empty(this.tableElement);\n      var tableRows = [];\n\n      _lodash.default.each(this.dataValue, function (value, key) {\n        return tableRows.push(_this5.buildRow(value, key, state));\n      });\n\n      this.tableElement.appendChild(this.createHeader());\n      this.tableElement.appendChild(this.ce('tbody', null, tableRows));\n      this.tableElement.appendChild(this.ce('tfoot', null, this.ce('tr', null, this.ce('td', {\n        colspan: this.hasRemoveButtons() ? 3 : 2\n      }, this.addKeyButton()))));\n    }\n  }, {\n    key: \"createValueComponent\",\n    value: function createValueComponent(state) {\n      var _this6 = this;\n\n      var container = this.ce('td', {\n        class: 'col-9 col-sm-8'\n      });\n      var schema = this.component.valueComponent;\n      schema.hideLabel = true;\n      var value = this.addComponent(schema, container, {}, null, null, state);\n      value.on('change', function () {\n        return _this6.updateValue();\n      }, true);\n      return {\n        value: value,\n        container: container\n      };\n    }\n  }, {\n    key: \"buildRow\",\n    value: function buildRow(value, key, state) {\n      if (!this.rows[key]) {\n        this.rows[key] = this.createValueComponent(state);\n      }\n\n      var row = this.rows[key];\n      var lastColumn = null;\n\n      if (this.hasRemoveButtons()) {\n        row.remove = this.removeKeyButton(key);\n        lastColumn = this.ce('td', {\n          class: 'col-1 col-sm-1'\n        }, row.remove);\n      }\n\n      row.element = this.ce('tr', {\n        class: 'd-flex',\n        id: \"\".concat(this.component.id, \"-row-\").concat(key)\n      }); // Create our key input.\n\n      row.keyInput = this.ce('input', {\n        type: 'text',\n        class: 'form-control',\n        id: \"\".concat(this.component.id, \"-value-\").concat(key),\n        value: key\n      });\n      this.addInput(row.keyInput);\n\n      if (this.component.keyBeforeValue) {\n        row.element.appendChild(this.ce('td', {\n          class: 'col-2 col-sm-3'\n        }, row.keyInput));\n        row.element.appendChild(row.container);\n      } else {\n        row.element.appendChild(row.container);\n        row.element.appendChild(this.ce('td', null, row.keyInput));\n      }\n\n      row.element.appendChild(lastColumn); // Set the value on the value component.\n\n      row.value.setValue(value);\n      return row.element;\n    }\n  }, {\n    key: \"addRow\",\n    value: function addRow() {\n      var component = this.createValueComponent();\n      var key = (0, _utils.uniqueKey)(this.dataValue, _lodash.default.camelCase(component.value.defaultValue) || 'key');\n      this.rows[key] = component;\n      this.dataValue[key] = component.value.defaultValue;\n      this.buildRows();\n      this.triggerChange();\n    }\n  }, {\n    key: \"removeRow\",\n    value: function removeRow(key) {\n      var value = this.dataValue;\n      delete value[key];\n      this.dataValue = value;\n      this.buildRows();\n      this.triggerChange();\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(flags, value) {\n      return _Base.default.prototype.updateValue.call(this, flags, value);\n    }\n  }, {\n    key: \"setValue\",\n    value: function setValue(value) {\n      var changed = this.hasChanged(value, this.dataValue);\n      this.dataValue = value;\n\n      if (changed) {\n        this.buildRows();\n      }\n\n      return changed;\n    }\n    /**\n     * Get the value of this component.\n     *\n     * @returns {*}\n     */\n\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      var value = {};\n\n      _lodash.default.each(this.rows, function (row) {\n        value[row.keyInput.value] = row.value.getValue();\n      });\n\n      return value;\n    }\n  }, {\n    key: \"defaultSchema\",\n    get: function get() {\n      return DataMapComponent.schema();\n    }\n  }, {\n    key: \"emptyValue\",\n    get: function get() {\n      return {};\n    }\n  }, {\n    key: \"componentComponents\",\n    get: function get() {\n      return [this.component.valueComponent];\n    }\n  }]);\n\n  return DataMapComponent;\n}(_NestedComponent2.default);\n\nexports.default = DataMapComponent;",null]}