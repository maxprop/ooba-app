{"remainingRequest":"/Users/scottjoscelyne/Desktop/oasis/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js??ref--8-1!/Users/scottjoscelyne/Desktop/oasis/node_modules/formiojs/PDFBuilder.js","dependencies":[{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/formiojs/PDFBuilder.js","mtime":1581861142187},{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/cache-loader/dist/cjs.js","mtime":1571276078087},{"path":"/Users/scottjoscelyne/Desktop/oasis/node_modules/@angular-devkit/build-optimizer/src/build-optimizer/webpack-loader.js","mtime":1571276072802}],"contextDependencies":[],"result":["\"use strict\";\n\nrequire(\"core-js/modules/es.symbol\");\n\nrequire(\"core-js/modules/es.symbol.description\");\n\nrequire(\"core-js/modules/es.symbol.iterator\");\n\nrequire(\"core-js/modules/es.array.find\");\n\nrequire(\"core-js/modules/es.array.iterator\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor\");\n\nrequire(\"core-js/modules/es.object.get-prototype-of\");\n\nrequire(\"core-js/modules/es.object.to-string\");\n\nrequire(\"core-js/modules/es.reflect.get\");\n\nrequire(\"core-js/modules/es.string.iterator\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nvar _WebformBuilder2 = _interopRequireDefault(require(\"./WebformBuilder\"));\n\nvar _utils = require(\"./utils/utils\");\n\nvar _PDF = _interopRequireDefault(require(\"./PDF\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nvar PDFBuilder =\n/*#__PURE__*/\nfunction (_WebformBuilder) {\n  _inherits(PDFBuilder, _WebformBuilder);\n\n  function PDFBuilder() {\n    _classCallCheck(this, PDFBuilder);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PDFBuilder).apply(this, arguments));\n  }\n\n  _createClass(PDFBuilder, [{\n    key: \"addDropZone\",\n    value: function addDropZone() {\n      var _this = this;\n\n      if (!this.dropZone) {\n        this.dropZone = this.ce('div', {\n          class: 'formio-drop-zone'\n        });\n        this.prepend(this.dropZone);\n      }\n\n      this.addEventListener(this.dropZone, 'dragover', function (event) {\n        event.preventDefault();\n        return false;\n      });\n      this.addEventListener(this.dropZone, 'drop', function (event) {\n        event.preventDefault();\n\n        _this.dragStop(event);\n\n        return false;\n      });\n      this.disableDropZone();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return this.onElement.then(function () {\n        _this2.build(_this2.clear());\n\n        _this2.isBuilt = true;\n\n        _this2.on('resetForm', function () {\n          return _this2.resetValue();\n        }, true);\n\n        _this2.on('refreshData', function () {\n          return _this2.updateValue();\n        }, true);\n\n        setTimeout(function () {\n          _this2.onChange();\n\n          _this2.emit('render');\n        }, 1);\n      });\n    }\n  }, {\n    key: \"enableDropZone\",\n    value: function enableDropZone() {\n      if (this.dropZone) {\n        var iframeRect = (0, _utils.getElementRect)(this.pdfForm.element);\n        this.dropZone.style.height = iframeRect && iframeRect.height ? \"\".concat(iframeRect.height, \"px\") : '1000px';\n        this.dropZone.style.width = iframeRect && iframeRect.width ? \"\".concat(iframeRect.width, \"px\") : '100%';\n        this.addClass(this.dropZone, 'enabled');\n      }\n    }\n  }, {\n    key: \"disableDropZone\",\n    value: function disableDropZone() {\n      if (this.dropZone) {\n        this.removeClass(this.dropZone, 'enabled');\n      }\n    }\n  }, {\n    key: \"addComponentTo\",\n    value: function addComponentTo(schema, parent, element, sibling) {\n      var comp = _get(_getPrototypeOf(PDFBuilder.prototype), \"addComponentTo\", this).call(this, schema, parent, element, sibling);\n\n      comp.isNew = true;\n\n      if (this.pdfForm && schema.overlay) {\n        this.pdfForm.postMessage({\n          name: 'addElement',\n          data: schema\n        });\n      }\n\n      return comp;\n    }\n  }, {\n    key: \"addComponent\",\n    value: function addComponent(component, element, data, before, noAdd, state) {\n      return _get(_getPrototypeOf(PDFBuilder.prototype), \"addComponent\", this).call(this, component, element, data, before, true, state);\n    }\n  }, {\n    key: \"deleteComponent\",\n    value: function deleteComponent(component) {\n      if (this.pdfForm && component.component) {\n        this.pdfForm.postMessage({\n          name: 'removeElement',\n          data: component.component\n        });\n      }\n\n      return _get(_getPrototypeOf(PDFBuilder.prototype), \"deleteComponent\", this).call(this, component);\n    }\n  }, {\n    key: \"dragStart\",\n    value: function dragStart(event, component) {\n      event.stopPropagation();\n      event.dataTransfer.setData('text/plain', 'true');\n      this.currentComponent = component;\n      this.enableDropZone();\n    }\n  }, {\n    key: \"removeEventListeners\",\n    value: function removeEventListeners(all) {\n      var _this3 = this;\n\n      _get(_getPrototypeOf(PDFBuilder.prototype), \"removeEventListeners\", this).call(this, all);\n\n      _lodash.default.each(this.groups, function (group) {\n        _lodash.default.each(group.components, function (builderComponent) {\n          _this3.removeEventListener(builderComponent, 'dragstart');\n\n          _this3.removeEventListener(builderComponent, 'dragend');\n        });\n      });\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      var state = {};\n      this.destroy(state);\n      return state;\n    }\n  }, {\n    key: \"redraw\",\n    value: function redraw() {\n      if (this.pdfForm) {\n        this.pdfForm.postMessage({\n          name: 'redraw'\n        });\n      }\n    }\n  }, {\n    key: \"dragStop\",\n    value: function dragStop(event) {\n      var schema = this.currentComponent ? this.currentComponent.schema : null;\n\n      if (!schema) {\n        return false;\n      } // Special case for file components - default to image mode when added via PDF builder\n\n\n      if (schema.type === 'file') {\n        schema.image = true;\n      }\n\n      schema.overlay = {\n        top: event.offsetY,\n        left: event.offsetX,\n        width: schema.defaultOverlayWidth || 100,\n        height: schema.defaultOverlayHeight || 20\n      };\n      this.addComponentTo(schema, this, this.getContainer());\n      this.disableDropZone();\n      return false;\n    } // Don't need to add a submit button here... the pdfForm will already do this.\n\n  }, {\n    key: \"addSubmitButton\",\n    value: function addSubmitButton() {}\n  }, {\n    key: \"addBuilderComponent\",\n    value: function addBuilderComponent(component, group) {\n      var _this4 = this;\n\n      var builderComponent = _get(_getPrototypeOf(PDFBuilder.prototype), \"addBuilderComponent\", this).call(this, component, group);\n\n      if (builderComponent) {\n        builderComponent.element.draggable = true;\n        builderComponent.element.setAttribute('draggable', true);\n        this.addEventListener(builderComponent.element, 'dragstart', function (event) {\n          return _this4.dragStart(event, component);\n        }, true);\n        this.addEventListener(builderComponent.element, 'dragend', function () {\n          return _this4.disableDropZone();\n        }, true);\n      }\n\n      return builderComponent;\n    }\n  }, {\n    key: \"refreshDraggable\",\n    value: function refreshDraggable() {\n      this.addSubmitButton();\n      this.builderReadyResolve();\n    }\n  }, {\n    key: \"build\",\n    value: function build() {\n      var _this5 = this;\n\n      this.buildSidebar();\n\n      if (!this.pdfForm) {\n        this.element.noDrop = true;\n        this.pdfForm = new _PDF.default(this.element, this.options);\n        this.addClass(this.pdfForm.element, 'formio-pdf-builder');\n      }\n\n      this.pdfForm.destroy(true);\n      this.pdfForm.on('iframe-elementUpdate', function (schema) {\n        var component = _this5.getComponentById(schema.id);\n\n        if (component && component.component) {\n          component.component.overlay = {\n            page: schema.page,\n            left: schema.left,\n            top: schema.top,\n            height: schema.height,\n            width: schema.width\n          };\n\n          _this5.editComponent(component);\n\n          _this5.emit('updateComponent', component);\n        }\n\n        return component;\n      }, true);\n      this.pdfForm.on('iframe-componentUpdate', function (schema) {\n        var component = _this5.getComponentById(schema.id);\n\n        if (component && component.component) {\n          component.component.overlay = {\n            page: schema.overlay.page,\n            left: schema.overlay.left,\n            top: schema.overlay.top,\n            height: schema.overlay.height,\n            width: schema.overlay.width\n          };\n\n          _this5.emit('updateComponent', component);\n\n          var localComponent = _lodash.default.find(_this5.form.components, {\n            id: schema.id\n          });\n\n          if (localComponent) {\n            localComponent.overlay = _lodash.default.clone(component.component.overlay);\n          }\n\n          _this5.emit('change', _this5.form);\n        }\n\n        return component;\n      }, true);\n      this.pdfForm.on('iframe-componentClick', function (schema) {\n        var component = _this5.getComponentById(schema.id);\n\n        if (component) {\n          _this5.editComponent(component);\n        }\n      }, true);\n      this.addComponents();\n      this.addDropZone();\n      this.updateDraggable();\n      this.formReadyResolve();\n    }\n  }, {\n    key: \"setForm\",\n    value: function setForm(form) {\n      var _this6 = this;\n\n      // If this is a brand new form, make sure it has a submit button component\n      if (!form.created && !_lodash.default.find(form.components || [], {\n        type: 'button',\n        key: 'submit'\n      })) {\n        form.components.push({\n          type: 'button',\n          label: this.t('Submit'),\n          key: 'submit',\n          size: 'md',\n          block: false,\n          action: 'submit',\n          disableOnInvalid: true,\n          theme: 'primary'\n        });\n      }\n\n      return _get(_getPrototypeOf(PDFBuilder.prototype), \"setForm\", this).call(this, form).then(function () {\n        return _this6.ready.then(function () {\n          // Ensure PDFBuilder component IDs are included in form schema to prevent desync with child PDF\n          var formCopy = _lodash.default.cloneDeep(form);\n\n          formCopy.components.forEach(function (c, i) {\n            return c.id = _this6.components[i].id;\n          });\n\n          if (_this6.pdfForm) {\n            return _this6.pdfForm.setForm(formCopy);\n          }\n\n          return form;\n        });\n      });\n    }\n  }, {\n    key: \"defaultComponents\",\n    get: function get() {\n      return {\n        pdf: {\n          title: 'PDF Fields',\n          weight: 0,\n          default: true,\n          components: {\n            textfield: true,\n            number: true,\n            password: true,\n            email: true,\n            phoneNumber: true,\n            currency: true,\n            checkbox: true,\n            signature: true,\n            select: true,\n            textarea: true,\n            datetime: true,\n            file: true\n          }\n        },\n        basic: false,\n        advanced: false,\n        layout: false,\n        data: false,\n        premium: false,\n        resource: false\n      };\n    }\n  }]);\n\n  return PDFBuilder;\n}(_WebformBuilder2.default);\n\nexports.default = PDFBuilder;",null]}